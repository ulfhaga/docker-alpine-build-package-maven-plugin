# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=mycroft-gui
pkgver=1.0.1
pkgrel=0
pkgdesc="The Graphical User Interface used by the Mycroft Mark II and more"
url="https://mycroft.ai"
# ppc64le, s390x, armhf, mips and mips64 blocked by qt5-qtwebview
arch="all !ppc64le !s390x !armhf !mips !mips64"
license="Apache-2.0"
depends="kirigami2 mycroft-skill-mark2"
makedepends="
	extra-cmake-modules
	kdbusaddons-dev
	kio-dev
	plasma-framework-dev
	qt5-qtbase-dev
	qt5-qtdeclarative-dev
	qt5-qtwebsockets-dev
	qt5-qtwebview-dev
	"
checkdepends="xvfb-run"
source="https://github.com/MycroftAI/mycroft-gui/archive/v$pkgver/mycroft-gui-v$pkgver.tar.gz"

build() {
	cmake -B build \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DBUILD_REMOTE_TTS=OFF
	cmake --build build
}

check() {
	cd build
	CTEST_OUTPUT_ON_FAILURE=TRUE xvfb-run ctest
}

package() {
	DESTDIR="$pkgdir" cmake --build build --target install
}

sha512sums="3177f0defd653771874b4f94a05abd1047e056a3f70a24a0e47aaa4f4155f88d3a0088715a731c20adf05db5bdcc630e2965388880d72c61d617ff3c1fde1448  mycroft-gui-v1.0.1.tar.gz"
